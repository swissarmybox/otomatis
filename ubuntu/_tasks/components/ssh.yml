- name: ssh | only allow ipv4
  become: true
  lineinfile:
    dest: /etc/ssh/sshd_config
    regexp: '^#?AddressFamily'
    line: "AddressFamily inet"
    backup: yes

- name: ssh | disable root login
  become: true
  lineinfile:
    dest: /etc/ssh/sshd_config
    regexp: '^#?PermitRootLogin'
    line: "PermitRootLogin no"
    backup: yes

- name: ssh | disable password authentication
  become: true
  lineinfile:
    dest: /etc/ssh/sshd_config
    regexp: '^#?PasswordAuthentication'
    line: "PasswordAuthentication no"
    backup: yes

- name: ssh | restart
  become: true
  systemd:
    name: sshd
    state: restarted
